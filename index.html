<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Invernadero</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
  <div class="app">

    <!-- Drawer de navegación -->
    <nav id="nav-drawer" class="nav-drawer">
      <a href="#dashboard" id="tab-dashboard">Dashboard</a>
      <a href="#actuators" id="tab-actuators">Actuadores</a>
      <a href="#history"   id="tab-history">Historial</a>
      <a href="#config"    id="tab-config">Config</a>
    </nav>
    <div id="menu-backdrop" class="menu-backdrop hidden"></div>

    <!-- Topbar GLOBAL -->
    <header class="topbar">
      <div class="topbar-left">
        <button id="btn-back" class="btn-nav hidden" aria-label="volver">←</button>
        <button id="btn-menu" class="btn-nav" aria-label="menu" aria-expanded="false" aria-controls="nav-drawer">&#9776;</button>
      </div>
      <h2 id="topbar-title" class="topbar-title">Invernadero</h2>
      <span class="pill pill-online">Online</span>
    </header>

    <!-- Dashboard (VISIBLE por defecto) -->
    <section id="view-dashboard">
      <div class="cards">
        <div id="card-temp-card" class="card card-grad">
          <div class="card-title">Temperatura</div>
          <div class="card-value" id="card-temp-value">--°C</div>
        </div>
        <div id="card-hum-card" class="card card-grad">
          <div class="card-title">Humedad ambiente</div>
          <div class="card-value" id="card-hum-value">--%</div>
        </div>
        <div id="card-humsoil-card" class="card card-grad">
          <div class="card-title">Humedad de suelo</div>
          <div class="card-value" id="card-humsoil-value">—%</div>
        </div>
      </div>

      <div class="card">
        <div class="card-title">Histórico <small>24h</small></div>
        <canvas id="chart-24h" width="360" height="140"></canvas>
      </div>

      <div class="card">
        Última lectura: <span id="last-ts">--:--:--</span>
      </div>
    </section>

    <!-- Configuración (OCULTA al inicio) -->
    <section id="view-config" class="hidden">
      <div><label>Temp máx <input id="in-tempMax" type="number" min="-10" max="60" step="0.1"></label></div>
      <div><label>Humedad mín <input id="in-humMin" type="number" min="0" max="100" step="1"></label></div>
      <div><label>Luz mín <input id="in-luxMin" type="number" min="0" max="20000" step="10"></label></div>
      <button id="btn-save-thresholds">Guardar</button>
      <button id="btn-reset-thresholds">Restaurar</button>
      <div id="msg-config"></div>
    </section>

    <!-- Actuadores (OCULTA al inicio) -->
    <section id="view-actuators" class="hidden">
      <div id="act-bomba">
        <strong>Bomba</strong>
        <span id="lbl-bomba-estado"></span>
        <button id="btn-bomba-manual">ON/OFF</button>
        <label><input type="checkbox" id="chk-bomba-auto"> Auto</label>
      </div>
      <div id="act-ventilador">
        <strong>Ventilador</strong>
        <span id="lbl-ventilador-estado"></span>
        <button id="btn-ventilador-manual">ON/OFF</button>
        <label><input type="checkbox" id="chk-ventilador-auto"> Auto</label>
      </div>
      <div id="act-luces">
        <strong>Luces</strong>
        <span id="lbl-luces-estado"></span>
        <button id="btn-luces-manual">ON/OFF</button>
        <label><input type="checkbox" id="chk-luces-auto"> Auto</label>
      </div>
    </section>

    <!-- Historial (OCULTA al inicio) -->
    <section id="view-history" class="hidden">
      <h2>Historial (últimas 10)</h2>
      <table id="hist-table"></table>
      <button id="btn-export-csv">Exportar CSV</button>
      <button id="btn-export-json">Exportar JSON</button>
      <button id="btn-clear-history">Borrar</button>
    </section>

    <!-- Simulación (OCULTA al inicio) -->
    <section id="view-sim" class="hidden">
      <h2>Simulación</h2>
      <button id="btn-sim-1">Simular 1 lectura</button>
      <button id="btn-sim-10">Simular 10 lecturas</button>
      <label style="margin-left:8px;"><input type="checkbox" id="chk-sim-auto"> Auto cada 3s</label>
    </section>

  </div>

  <!-- Scripts -->
  <script src="js/thresholds.js"></script>
  <script src="js/actuators.js"></script>
  <script src="js/history.js"></script>
  <script src="js/sensors.js"></script>
  <script src="js/main.js"></script>
</body>
</html>

